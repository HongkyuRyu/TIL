- - - 
# 파이썬 데이터 처리 프로그래밍 4일차

#2023-08-03

## 실습 - 인스타그램(웹 앱) 크롤링
- 페이지 로딩이 없는 홈페이지이다.
- 따라서, Pause를 통해 해당 내용이 보일 때까지 기다려주어야 한다.
- 로그인이 필요하므로, 바탕화면에 로그인 정보를 저장해준다.

==로그인정보와 방문 기록을 저장하는 경로 설정==
```python
options = webdriver.ChromeOptions()
options.add_argument("--user-data-dir=C:\\Users\\user\\Desktop\\Mychrome")
```

- 인기 게시물을 긁어서 해당 내용을 가져오도록 한다.
```python
from selenium import webdriver
from selenium.webdriver.chrome.service import Service
from webdriver_manager.chrome import ChromeDriverManager
from selenium.webdriver.common.by import By
# 로그인 정보, 방문 기록을 저장하는 경로 설정
from selenium.webdriver.common.action_chains import ActionChains
from selenium.webdriver.common.keys import Keys
import time

options = webdriver.ChromeOptions()
options.add_argument("--user-data-dir=C:\\Users\\user\\Desktop\\Mychrome")


service = Service(ChromeDriverManager().install())
d = webdriver.Chrome(service=service, options=options)
try:
    d.get("https://www.instagram.com/")
    time.sleep(5)
    #input()
    
    buttons = d.find_elements(By.CSS_SELECTOR, ".xvy4d1p")
    search_button = buttons[2]
    # 검색 버튼을 클릭해줘.
    ac = ActionChains(d) # 할 작업 액션들을 정의
    ac.move_to_element(search_button)
    ac.click()
    ac.pause(1) # 액션이 있으면 기다렸다가
    ac.perform()
    
    # 검색 버튼이 열리면 검색 창에 #파이썬이라고 검색해줘
    elem = d.find_element(By.CSS_SELECTOR, ".x7xwk5j")
    ac = ActionChains(d)
    ac.move_to_element(elem)
    ac.click()
    ac.send_keys("#파이썬")
    ac.send_keys(Keys.RETURN)
    ac.pause(5)
    ac.move_by_offset(0, 100) # x,y축으로 주어진 수치만큼 이동한다.(마우스포인터)
    #ac.context_click() # offset 위치를 계산해볼 수 있다.
    ac.click()
    ac.perform()
    time.sleep(5)
    
    # 인기 게시물을 긁어서, 해당 내용을 긁어오도록 한다.
    posts = d.find_elements(By.CSS_SELECTOR, "._aabd")
    for post in posts:
        ac = ActionChains(d)
        ac.click(post) # 클릭 이벤트
        ac.pause(5)
        ac.perform() #실행된 후에
        
        content = d.find_element(By.CSS_SELECTOR, "._a9zr > ._a9zs > ._aade")
        print(content.text)
        
        ac.reset_actions()
        ac.send_keys(Keys.ESCAPE)
        ac.pause(1)
        ac.perform()
        
    time.sleep(5)
    
except Exception as e:
    print(e)
finally:
    d.close()
    d.quit()
```
![](https://i.imgur.com/Sh02KPC.png)
